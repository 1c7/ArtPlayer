{"version":3,"file":"artplayer-plugin-subtitle.js","sources":["../../../packages/artplayer-plugin-subtitle/node_modules/@babel/runtime/helpers/typeof.js","../../../packages/artplayer-plugin-subtitle/src/index.js"],"sourcesContent":["function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function artplayerPluginSubtitle(option) {\n    return art => {\n        const { errorHandle, clamp, sleep } = art.constructor.utils;\n\n        errorHandle(\n            option && typeof option.time === 'number',\n            `The plugin 'artplayerPluginSubtitle': 'option.time' require 'number' type, but got '${typeof option.time}'`,\n        );\n\n        let retry = 0;\n        const maxRetry = 10;\n        const time = clamp(option.time, -10, 10);\n\n        function adjust() {\n            errorHandle(retry < maxRetry, 'It seems that something wrong for reading subtitle');\n            retry += 1;\n            const cues = Array.from(art.refs.$track.track.cues);\n            if (cues.length === 0) {\n                sleep(100).then(adjust);\n            } else {\n                cues.forEach(cue => {\n                    cue.startTime += time;\n                    cue.endTime += time;\n                });\n            }\n        }\n\n        art.on('subtitle:load', adjust);\n    };\n}\n\nwindow.artplayerPluginSubtitle = artplayerPluginSubtitle;\nexport default artplayerPluginSubtitle;\n"],"names":["artplayerPluginSubtitle","option","art","constructor","utils","errorHandle","clamp","sleep","time","retry","maxRetry","adjust","cues","Array","from","refs","$track","track","length","then","forEach","cue","startTime","endTime","on","window"],"mappings":";;;;;;;;;;;CAAA,SAAS,QAAQ,CAAC,GAAG,EAAE,EAAE,IAAI,OAAO,MAAM,KAAK,UAAU,IAAI,OAAO,MAAM,CAAC,QAAQ,KAAK,QAAQ,EAAE,EAAE,QAAQ,GAAG,SAAS,QAAQ,CAAC,GAAG,EAAE,EAAE,OAAO,OAAO,GAAG,CAAC,EAAE,CAAC,EAAE,MAAM,EAAE,QAAQ,GAAG,SAAS,QAAQ,CAAC,GAAG,EAAE,EAAE,OAAO,GAAG,IAAI,OAAO,MAAM,KAAK,UAAU,IAAI,GAAG,CAAC,WAAW,KAAK,MAAM,IAAI,GAAG,KAAK,MAAM,CAAC,SAAS,GAAG,QAAQ,GAAG,OAAO,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE;;CAErW,SAAS,OAAO,CAAC,GAAG,EAAE;GACpB,IAAI,OAAO,MAAM,KAAK,UAAU,IAAI,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;KAC1E,cAAc,GAAG,OAAO,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE;OAC/C,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC;MACtB,CAAC;IACH,MAAM;KACL,cAAc,GAAG,OAAO,GAAG,SAAS,OAAO,CAAC,GAAG,EAAE;OAC/C,OAAO,GAAG,IAAI,OAAO,MAAM,KAAK,UAAU,IAAI,GAAG,CAAC,WAAW,KAAK,MAAM,IAAI,GAAG,KAAK,MAAM,CAAC,SAAS,GAAG,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC;MACjI,CAAC;IACH;;GAED,OAAO,OAAO,CAAC,GAAG,CAAC,CAAC;EACrB;;CAED,cAAc,GAAG,OAAO;;;CChBxB,SAASA,uBAAT,CAAiCC,MAAjC,EAAyC;CACrC,SAAO,UAAAC,GAAG,EAAI;CAAA,gCAC4BA,GAAG,CAACC,WAAJ,CAAgBC,KAD5C;CAAA,QACFC,WADE,yBACFA,WADE;CAAA,QACWC,KADX,yBACWA,KADX;CAAA,QACkBC,KADlB,yBACkBA,KADlB;CAGVF,IAAAA,WAAW,CACPJ,MAAM,IAAI,OAAOA,MAAM,CAACO,IAAd,KAAuB,QAD1B,0GAEuFP,MAAM,CAACO,IAF9F,QAAX;CAKA,QAAIC,KAAK,GAAG,CAAZ;CACA,QAAMC,QAAQ,GAAG,EAAjB;CACA,QAAMF,IAAI,GAAGF,KAAK,CAACL,MAAM,CAACO,IAAR,EAAc,CAAC,EAAf,EAAmB,EAAnB,CAAlB;;CAEA,aAASG,MAAT,GAAkB;CACdN,MAAAA,WAAW,CAACI,KAAK,GAAGC,QAAT,EAAmB,oDAAnB,CAAX;CACAD,MAAAA,KAAK,IAAI,CAAT;CACA,UAAMG,IAAI,GAAGC,KAAK,CAACC,IAAN,CAAWZ,GAAG,CAACa,IAAJ,CAASC,MAAT,CAAgBC,KAAhB,CAAsBL,IAAjC,CAAb;;CACA,UAAIA,IAAI,CAACM,MAAL,KAAgB,CAApB,EAAuB;CACnBX,QAAAA,KAAK,CAAC,GAAD,CAAL,CAAWY,IAAX,CAAgBR,MAAhB;CACH,OAFD,MAEO;CACHC,QAAAA,IAAI,CAACQ,OAAL,CAAa,UAAAC,GAAG,EAAI;CAChBA,UAAAA,GAAG,CAACC,SAAJ,IAAiBd,IAAjB;CACAa,UAAAA,GAAG,CAACE,OAAJ,IAAef,IAAf;CACH,SAHD;CAIH;CACJ;;CAEDN,IAAAA,GAAG,CAACsB,EAAJ,CAAO,eAAP,EAAwBb,MAAxB;CACH,GA3BD;CA4BH;;CAEDc,MAAM,CAACzB,uBAAP,GAAiCA,uBAAjC;;;;;;;;;;;;"}