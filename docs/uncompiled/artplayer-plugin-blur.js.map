{"version":3,"file":"artplayer-plugin-blur.js","sources":["../../packages/artplayer-plugin-blur/node_modules/blur-image-url/index.js","../../packages/artplayer-plugin-blur/src/index.js"],"sourcesContent":["(function(window, factory) {\n  if (typeof exports === 'object') {\n    module.exports = factory();\n  } else if (typeof define === 'function' && define.amd) {\n    define(factory);\n  } else {\n    window.blurImageUrl = factory();\n  }\n})(this, function() {\n  return function blurImageUrl(url, radius) {\n    return new Promise(function(resolve) {\n      var img = new Image();\n      img.onload = function() {\n        var w = img.naturalWidth;\n        var h = img.naturalHeight;\n        var canvas = document.createElement('canvas');\n        canvas.style.width = w + 'px';\n        canvas.style.height = h + 'px';\n        canvas.width = w;\n        canvas.height = h;\n        var context = canvas.getContext('2d');\n        context.filter = `blur(${radius}px)`;\n        context.drawImage(\n          img,\n          -radius,\n          -radius,\n          w + radius * 2,\n          h + radius * 2\n        );\n        canvas.toBlob(function(blob) {\n          resolve(URL.createObjectURL(blob));\n          img.onload = null;\n        });\n      };\n      img.src = url;\n    });\n  };\n});\n","import blurImageUrl from '../node_modules/blur-image-url';\n\nfunction artplayerPluginBlur(art) {\n    const { errorHandle, clamp } = art.constructor.utils;\n    const { player } = art;\n    return {\n        name: 'artplayerPluginBlur',\n        attach($ref, radius = 15) {\n            errorHandle($ref instanceof Element, 'The attach element is not a dom element');\n            $ref.style.backgroundRepeat = 'no-repeat';\n            $ref.style.transition = 'all .2s ease';\n\n            function show() {\n                const { left, top } = $ref.getBoundingClientRect();\n                $ref.style.backgroundImage = 'none';\n                $ref.style.backgroundSize = `${player.width}px ${player.height}px`;\n                $ref.style.backgroundPosition = `${player.left - left}px ${player.top - top}px`;\n                player.getScreenshotBlobUrl().then(url => {\n                    blurImageUrl(url, clamp(radius, 0, 50)).then(img => {\n                        $ref.style.backgroundImage = `url(${img})`;\n                        $ref.style.visibility = 'visible';\n                        $ref.style.opacity = '1';\n                        $ref.style.pointerEvents = 'all';\n                    });\n                });\n            }\n\n            function hide() {\n                $ref.style.visibility = 'hidden';\n                $ref.style.opacity = '0';\n                $ref.style.pointerEvents = 'none';\n                $ref.style.backgroundImage = 'none';\n            }\n\n            hide();\n            art.on('video:pause', show);\n            art.on('video:ended', show);\n            art.on('video:seeked', show);\n            art.on('video:playing', hide);\n            art.on('video:timeupdate', hide);\n        },\n    };\n}\n\nexport default artplayerPluginBlur;\n"],"names":["this","artplayerPluginBlur","art","constructor","utils","errorHandle","clamp","player","name","attach","$ref","radius","Element","style","backgroundRepeat","transition","show","getBoundingClientRect","left","top","backgroundImage","backgroundSize","width","height","backgroundPosition","getScreenshotBlobUrl","then","url","blurImageUrl","img","visibility","opacity","pointerEvents","hide","on"],"mappings":"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"}